{"version":3,"file":"development.js","sources":["../src/components/emoji.js","../src/hubs/emoji.js","../src/main.js"],"sourcesContent":["AFRAME.registerComponent(\"socialvr-emoji\", {\r\n  dependencies: [\"is-remote-hover-target\"],\r\n\r\n  init: function() {\r\n    console.log(\"[Social VR] Emoji System - Initialized\");\r\n\r\n    this.el.setAttribute(\"tags\", \"singleActionButton: true\");\r\n    this.el.setAttribute(\"css-class\", \"interactable\");\r\n\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick.bind(this));\r\n  },\r\n  \r\n  remove: function() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick.bind(this));\r\n  },\r\n\r\n  onClick: function() {\r\n    window.APP.utils.spawnEmojiInFrontOfUser(window.APP.utils.emojis[0]);\r\n  }\r\n});","// modified https://github.com/mozilla/hubs/blob/hubs-cloud/src/components/emoji.js\r\n\r\nAFRAME.registerComponent(\"hubs-emoji\", {\r\n  schema: {\r\n    emitDecayTime: { default: 1.5 },\r\n    emitFadeTime: { default: 0.5 },\r\n    emitEndTime: { default: 0 },\r\n    particleEmitterConfig: {\r\n      default: null,\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n\r\n  init() {\r\n    this.data.emitEndTime = performance.now() + this.data.emitDecayTime * 1000;\r\n    this.physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n  },\r\n\r\n  play() {\r\n    const mediaLoader = this.el.components[\"media-loader\"];\r\n    if (window.APP.utils.emojis.find(emoji => emoji.model !== mediaLoader.data.src) === -1) {\r\n      this.el.parentNode.removeChild(this.el);\r\n      return;\r\n    }\r\n\r\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\r\n      SOUND_SPAWN_EMOJI,\r\n      this.el.object3D\r\n    );\r\n    this.particleEmitter = this.el.querySelector(\".particle-emitter\");\r\n  },\r\n\r\n  update() {\r\n    if (!this.particleConfig && this.data.particleEmitterConfig) {\r\n      this.particleConfig = Object.assign({}, this.data.particleEmitterConfig);\r\n      this.originalParticleCount = this.particleConfig.particleCount;\r\n    }\r\n  },\r\n\r\n  tick() {\r\n    const isMine = this.el.components.networked.initialized && this.el.components.networked.isMine();\r\n\r\n    if (this.particleConfig && isMine) {\r\n      const now = performance.now();\r\n\r\n      const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\r\n\r\n      if (isHeld) {\r\n        this.data.emitEndTime = now + this.data.emitDecayTime * 1000;\r\n      }\r\n\r\n      const emitFadeTime = this.data.emitFadeTime * 1000;\r\n\r\n      if (now < this.data.emitEndTime && this.particleConfig.startOpacity < 1) {\r\n        this.particleConfig.particleCount = this.originalParticleCount;\r\n        this.particleConfig.startOpacity = 1;\r\n        this.particleConfig.middleOpacity = 1;\r\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\r\n      } else if (now >= this.data.emitEndTime && this.particleConfig.startOpacity > 0.001) {\r\n        const timeSinceStop = Math.min(now - this.data.emitEndTime, emitFadeTime);\r\n        const opacity = 1 - timeSinceStop / emitFadeTime;\r\n        const particleCount = opacity < 0.001 && this.particleConfig.particleCount > 0 ? 0 : this.originalParticleCount;\r\n        this.particleConfig.particleCount = particleCount;\r\n        this.particleConfig.startOpacity = opacity;\r\n        this.particleConfig.middleOpacity = opacity;\r\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\r\n      }\r\n    }\r\n  }\r\n});\r\n","// import \"./components/toolbox-button\";\r\n\r\n// const scene = document.querySelector(\"a-scene\");\r\n\r\n// ///////////\r\n// // BARGE //\r\n// ///////////\r\n\r\n// import \"./components/barge\";\r\n// import \"./components/barge-button\";\r\n// import \"./systems/barge\";\r\n// import { CreateBarge } from \"./systems/barge\";\r\n\r\n// const [barge, bargeToolboxButton] = CreateBarge();\r\n// scene.appendChild(barge);\r\n// scene.appendChild(bargeToolboxButton);\r\n\r\n// window.startPhaseTesting = function() {\r\n//   let phase = 1;\r\n//   barge.emit(\"advancePhaseEvent\");\r\n//   console.log(`[Social VR] Barge - Current Phase: ${phase}`);\r\n// };\r\n\r\n// /////////////\r\n// // SPEECH  //\r\n// /////////////\r\n\r\n// import \"./components/speech\";\r\n// import \"./systems/speech\";\r\n// import { CreateSpeech } from \"./systems/speech\";\r\n\r\n// const [speechVisEl, speechToolboxButton] = CreateSpeech();\r\n// scene.appendChild(speechVisEl);\r\n// scene.appendChild(speechToolboxButton);\r\n\r\nimport \"./components/emoji\";\r\nimport \"./hubs/emoji\";\r\n\r\nconst scene = document.querySelector(\"a-scene\");\r\n\r\nconst dummy = document.createElement(\"a-box\");\r\ndummy.setAttribute(\"socialvr-emoji\", \"\");\r\nscene.appendChild(dummy);\r\n\r\n//console.log(window.APP.utils.emojis);"],"names":[],"mappings":"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"}